<script src="https://player.vimeo.com/api/player.js"></script>
<button type="button" class="btn btn-secondary" id="fullscreen-button">Full Screen</button>
{% capture p1 %}{{ 'uploads/cc1.JPG' | absolute_url }}{% endcapture %}
{% capture p2 %}{{ 'uploads/cc4.jpg' | absolute_url }}{% endcapture %}
{% capture p3 %}{{ 'uploads/cc3.JPG' | absolute_url }}{% endcapture %}
{% capture v1 %}{{ 'uploads/wwd.png' | absolute_url }}{% endcapture %}
{% capture v2 %}{{ 'uploads/video-1.mp4' | absolute_url }}{% endcapture %}
{% capture v3 %}{{ 'uploads/marine-debris.png' | absolute_url }}{% endcapture %}
{% capture wt %}{{ 'uploads/whale-tail.png' | absolute_url }}{% endcapture %}
{% capture up %}{{ 'uploads/up-arrow.png' | absolute_url }}{% endcapture %}
{% capture down %}{{ 'uploads/down-arrow.png' | absolute_url }}{% endcapture %}
<div class="row no-gutters info">
  <div class="col align-self-center">
    <div id="title">
      <h4>Who we are</h4>
    </div>
    <div id="description">
      <h2><img src="{{ wt }}" class="px-3 py-2"/></h2>
      <p class="pl-3">Clayoquot Sound needs your help! Ocean plastics and other forms of pollution are washing ashore with every tide. This garbage threatens all kinds of wildlife, Indigenous culture, and the communities that call Clayoquot Sound home. Become a Coastal Ambassador and help protect this wonderful coast with us!<br><br>Travel in our helicopter to remote beaches within Clayoquot Sound and help our rehabilitation efforts to Restore Our Shore. Help us preserve these important areas for breeding, nesting, and foraging for so many kinds of wildlife. Learn about this wildlife from your guide as you enjoy a spectacular aerial safari on the way home.</p>
    </div>
    <div id="explore"><a href="" class="btn btn-primary btn-lg" id="explore-button">Explore</a></div>
  </div>
  <div class="col-7">
    <div class="row no-gutters">
      <div class="col-12">
        <div id="videoCarousel" class="carousel" data-ride="carousel">
          <div class="carousel-inner">
            <div class="carousel-item active">
              <div class="embed-responsive embed-responsive-16by9" id="v1">
                <iframe class="embed-responsive-item" src="https://player.vimeo.com/video/276692226" width="640" height="360" frameborder="0" allowfullscreen></iframe>
              </div>
            </div>
            <div class="carousel-item">
              <div class="embed-responsive embed-responsive-16by9">
                <iframe class="embed-responsive-item" src="https://player.vimeo.com/video/276691373" width="640" height="360" frameborder="0" allowfullscreen></iframe>
              </div>
            </div>
            <div class="carousel-item">
              <div class="embed-responsive embed-responsive-16by9">
                <iframe class="embed-responsive-item" src="https://player.vimeo.com/video/276692737" width="640" height="360" frameborder="0" allowfullscreen></iframe>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="col-12" id="arrows">
        <a class="carousel-control-prev" href="#videoCarousel" role="button" data-slide="prev" style='background-image: url("{{ p1 }}");background-size: cover;background-position: bottom;'>
          <img src="{{ down }}" style="max-width: 156px;">
          <span class="sr-only">Previous</span>
        </a>
        <a class="carousel-control-next" href="#videoCarousel" role="button" data-slide="next" style='background-image: url("{{ p2 }}");background-size: cover;background-position: bottom;'>
          <img src="{{ up }}" style="max-width: 156px;">
          <span class="sr-only">Next</span>
        </a>
      </div>
    </div>
  </div>
</div>

<script type="text/javascript">

var iframes = document.querySelectorAll('iframe');

function updateContent(txt, title) {
  var dTitle = $('#title h4');
  var description = $('#description p');
  dTitle.text(title);
  description.html(txt);
}

function switchVideo(currentIndex, previousIndex) {
  var toPlayer = new Vimeo.Player(iframes[currentIndex]);
  var fromPlayer = new Vimeo.Player(iframes[previousIndex]);

  toPlayer.play().then(function() {
      // the video was played
  }).catch(function(error) {
      switch (error.name) {
          case 'PasswordError':
              // the video is password-protected and the viewer needs to enter the
              // password first
              break;

          case 'PrivacyError':
              // the video is private
              break;

          default:
              // some other error occurred
              break;
      }
  });

  fromPlayer.pause().then(function() {
      // the video was paused
  }).catch(function(error) {
      switch (error.name) {
          case 'PasswordError':
              // the video is password-protected and the viewer needs to enter the
              // password first
              break;

          case 'PrivacyError':
              // the video is private
              break;

          default:
              // some other error occurred
              break;
      }
  });
}

function changeImages(currentIndex, previousIndex) {
  var img1;
  var img2;
  var txt;
  var title;
  switch (currentIndex) {
    case 0:
      img1 = "{{ p1 }}";
      img2 = "{{ p2 }}";
      txt = "Clayoquot Sound needs your help! Ocean plastics and other forms of pollution are washing ashore with every tide. This garbage threatens all kinds of wildlife, Indigenous culture, and the communities that call Clayoquot Sound home. Become a Coastal Ambassador and help protect this wonderful coast with us!<br><br>Travel in our helicopter to remote beaches within Clayoquot Sound and help our rehabilitation efforts to Restore Our Shore. Help us preserve these important areas for breeding, nesting, and foraging for so many kinds of wildlife. Learn about this wildlife from your guide as you enjoy a spectacular aerial safari on the way home.";
      title = "Who we are";
      updateContent(txt, title);
      break;
    case 1:
      img1 = "{{ p2 }}";
      img2 = "{{ p3 }}";
      txt = "Clayoquot CleanUp is a world leader in marine habitat restoration.  Specializing in emergency spill response, accumulated debris removal, and aquaculture site deconstruction and removal our team of technical experts possess advanced training and experience that assures successful restoration of demanding marine environments.";
      title = "What we do";
      updateContent(txt, title);
      break;
    case 2:
      img1 = "{{ p3 }}";
      img2 = "{{ p1 }}";
      txt = "Home to First Nations communities (Hesquiaht, Ahousaht, Tla-o-qui-aht) the District of Tofino, a plethora of visitors, part time residents and colorful characters, the biodiversity of our landscape is mirrored closely by the diversity of its human inhabitants.  Drawing from this diversity and the reliance we have upon the industries of fishing, aquaculture and eco-tourism, the link is clear between healthy landscapes and thriving wildlife and sustainable economic growth and development. <br><br>Clayoquot Sound acts as an aggregator for ocean plastics and marine debris from both domestic and international sources. Commercial fishing gear, jettisoned shipping containers, styrofoam insulation and household plastics are all prevalent examples of pollution that is turning Clayoquot Sound into a landfill.   As a result, cetaceans and other wildlife combat entanglement as a way of life. Whales perish in lost fishing gear, birds choke on plastics mistaken for food and the integrity of the ecosystem as a whole declines.";
      title = "Why clean up";
      updateContent(txt, title);
      break;
  }
  $(".carousel-control-prev").stop().animate({ opacity: 0 }, 150, function(){
    $(this).css({'background-image': "url("+img1+")"})
             .animate({ opacity: 1 },{ duration: 150 });
  });
  $(".carousel-control-next").stop().animate({ opacity: 0 }, 150, function(){
    $(this).css({'background-image': "url("+img2+")"})
             .animate({ opacity: 1 },{ duration: 150 });
  });
}

var videoCarousel = $('#videoCarousel');
videoCarousel.carousel({
  interval: false
})

videoCarousel.on('slid.bs.carousel', function (e) {
  if (e.to === 0) {
    changeImages(e.to, e.from)
    switchVideo(e.to, e.from);
  } else if (e.to == 1) {
    changeImages(e.to, e.from)
    switchVideo(e.to, e.from);
  } else if (e.to == 2) {
    changeImages(e.to, e.from)
    switchVideo(e.to, e.from);
  }
})

</script>
